<!DOCTYPE html>
<html>
<head>
    <title>Apibox UI</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- css -->
    <section>

        <script type="text/javascript" src="{{url_for('static',filename='js/jquery.js')}}"></script>
        <script type="text/javascript" src="{{url_for('static',filename='js/bootstrap.min.js')}}"></script>

    </section>

    <!-- css -->
    <link rel="stylesheet" href="{{url_for('static',filename='css/bootstrap.css')}}">
    <link rel="stylesheet" href="{{url_for('static',filename='css/animate.css')}}">
    <link rel="stylesheet" href="{{url_for('static',filename='css/main.css')}}">
</head>
<style type="text/css">
    /*.line-separator{
    height:1px;
    background:#717171;
    width: 510px;
    margin-left: 200px;
    border-bottom:1px solid #C6C5C7;
    }*/
    .height-40{
        height:40px;
    }
    .upload{
        background-color: #333;
color: #dfdfdf;width:120px;font-size:18px;text-transform:uppercase
    }
    .actual{
        position:absolute; top:-100px;
    }
    .indi-slide{
        display:none;padding-left:15px;padding-right:15px;background:white;border-top:1px solid #333;padding-top:10px;margin-right:-15px;margin-left:-15px
    }
</style>
<body ng-app="ApiboxUI">
<div class="header">
    <div class="container">
        <a href="#" class="link-a">login</a>
        <a href="#" class="logo"></a>
        <div class="clearfix"></div>

        <ul class="form-list">
            <!-- <li><input name="app_name" placeholder= "Application Name"></li> -->
            <img src="{{url_for('static',filename='img/mock.png')}}" style="margin-top:-100px">
            <form action="/app/new" method="POST" class="upload-form" enctype="multipart/form-data">
                <ul class="form-list">
                    <li>
                       <!--  <label class="label-form"> </label>
                        <div class="form-box">
                            
                        </div> -->
                        <input class="actual" type="file" name="filehere"></input>
                         <div class="input-group col-sm-8 col-sm-offset-2">
                           <input type="" class="form-control height-40 drop" name="" placeholder="Drop your JSON files here">
                           <div class="input-group-btn" style="">
                              <button class="btn btn-default height-40 upload" type="button" style="">
                                 Upload
                              </button>
                           </div>
                        </div>
                    </li>
                </ul>
                <!-- <button>Submit </button> -->

            </form>
            <script type="text/javascript">
            $(".drop").on("click",function(){
                $(".actual").click();

            });
            $(".actual").on("change",function(){
                $(".drop").val($(".actual").val());
            });
            $(".upload").on("click",function(){
                alert("hi");
                $(".upload-form").submit();
            });
            </script>
            
            

    </div>
</div>
<!--status goes here-->

<div class="container hide"  style="width:100%;height:50px;background: rgb(87, 202, 87);margin-top: -12px">
{%if status%}
    <span id="successMessage"  style="
    padding-left: 258px;
    font-weight: bolder;
    
    padding-top: 15px;
    color: black;
">{{status}} {%if status_url%} <a href="" style="color:blue;">{{status_url.replace('//','/')}}</a> {%endif%}
     {%if status_app%}<h1 style="color:blue;">{{status_app}}</h1> {%endif%}</span>
    {%endif%}
</div>

<script>
   // $('#successMessage').parent().delay(5000).fadeOut('slow');
</script>

<!--list of apis goes here-->
<div class="main-content" ng-controller="mainController" ng-init="init()">
    <div style="padding-bottom:50px">

        <div class= "two-tables" style= "padding-left: 50px;">
            <table class="container">
                <tr class="row">
                    <td  class="col-sm-6  text-left" style = "font-weight: 900;" >
                        <em>YOUR-</em>API
                    </td>
                    <td style = "font-weight: 900;" class="col-sm-6  text-right ">
                        <span class="glyphicon glyphicon-plus-sign "></span>
                        <a href="#" class="addnew" style = "font-weight: 900;">ADD NEW API</a>
                    </td>
                </tr>
            </table>
            <br>

            <script>

                                    $(".addnew").on("click",function(e){
                                    e.preventDefault();
                                    i=1;
                                    a=$(this).parent().parent();
                                    $(".slidedown").slideDown(1000);
                                    //$(".anc-1").addClass("hide");

                                });

                                 </script>

            <div class="container slidedown" style="display:none">
                <h2></h2>
                <div class="row">
                    <form class="form-horizontal col-sm-12" action="/app/endpoint/newone"  method="POST" role="form" ng-submit="saveRow()" style="padding-top:20px;">
                        <a href="#"><div class="clearfix">
                            <span class="glyphicon glyphicon-remove pull-right close"></span>
                        </div></a>

                        <div class="form-group">

                            <label class="col-sm-2 control-label">Select Application</label>
                            <div class="col-sm-10">
                                <div class="dropdown">

                                    <select class="form-control" name="appnames" style="width:30%;">
                                        {% for apps in a.keys()%}
                                        <option value="{{apps}}">{{apps}}</option>
                                        {%endfor%}
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group ">
                            <label class="col-sm-2 control-label">Path</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" name="path" ng-model="path"  style="
            width: 500px;
            border-radius: 0;
            "/ value="{{endpoint}}">
                            </div>
                        </div>
                        <input class="hide" value=""/>
                        <div class="form-group">

                            <label class="col-sm-2 control-label">Method</label>
                            <div class="col-sm-10">
                                <div class="dropdown">

                                    <select class="form-control" name="method" style="width:30%;">
                                        <option value="GET">GET</option>
                                        <option value="PUT">PUT</option>
                                        <option value="POST">POST</option>
                                        <option value="DELETE">DELETE</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Response</label>
                            <div class="col-sm-10">
<textarea type="text" class="form-control" name="response" ng-model="response" style="
width: 526px;
height: 164px;
border-radius: 0;
"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <div style="padding-left:172px">
                                <input type="submit" value="Submit" class="btn btn-primary" style="
background-color: #2E2C2C;
border-color: #2E2C2C;
border-radius: 0;
"/>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <script>    $(".close").on("click",function(e){
                                    e.preventDefault();

                                    a.removeClass("hide");
                                    $(".slidedown").slideUp(1000);
                                });
    </script>




            <div class="container" >
                <div style="height: 40px; background-color: #C2C2C2;" class="row">

                    <div style=" font-weight: 600; padding-left: 30px;padding-top: 10px;" class="col-sm-2">
                        Name
                    </div>
                    <div style="font-weight: 600; padding-top: 10px; padding-left: 100px;"class="col-sm-4">
                        Path
                    </div>

                    <div style= "padding-right: 50px; font-weight: 600;padding-top: 10px;"  class="col-sm-2">
                        Method
                    </div>
                    <div style= "padding-right: 50px; font-weight: 600;padding-top: 10px;"  class="col-sm-2">
                        Action
                    </div>
                    <div style= "padding-right: 50px; font-weight: 600;padding-top: 10px;" class="col-sm-2">
                        Status
                    </div>
                </div>
                {%if ste.keys()%}
                {% set count =0 %}
                {% for endpoint in ste.keys() %}
                {%set count = count+1%}
                {%set app_name= ste[endpoint].split('^')[1].split('$')[0]%}
                <div style="height: 40px;"  class="row">
                    <div class="col-sm-12">
                        <div style="padding-left: 10px;padding-top: 10px;" class="col-sm-2">
                            <a href= "#"  >{{app_name}}</a>
                            
                            


                        </div>
                        <div style= "padding-left: 50px;padding-right: 50px; padding-top: 10px;"   class="col-sm-4">
                            {% set url_path = app_name+endpoint %}
                            <a href= ""  class="anc-{{count}}">{{endpoint}}</a>
                        </div>
                        <script>

                                $(".anc-{{count}}").on("click",function(e){
                                e.preventDefault();
                                i=1;
                                a=$(this).parent().parent();
                                $(".slidedown-{{count}}").slideDown(1000);
                                //$(".anc-{{count}}").addClass("hide");

                            });

                            </script>

                        <div style= "padding-right: 50px; padding-top: 10px; "  class="col-sm-2">
                            {{ste[endpoint].split('$')[-1]}}
                        </div>
                        <div style= "padding-right: 50px; padding-top: 10px;" class="col-sm-2">
                            <form method="POST" action="/app/path/delete">
                            <input class="hide" name="path" value="{{endpoint}}"/>
                            <input class="hide" name="appname" value="{{app_name}}"/>
                            <button style="border: 0;
                            background: transparent;
                            color: black; ">Delete</button>
                            </form>
                        </div>
                        {% if ste[endpoint].startswith("started")%}
                        <div style= "padding-right: 50px; padding-top: 10px; color: green;" class="col-sm-2">
                            <form method="POST" action="/stop/{{ste[endpoint].split('^')[1].split('$')[0]}}/path">
                                <input name="path" class="hide" value="{{endpoint}}"/>
                                <button class= "startlink" style="
    border: 0;
    background: transparent;
    color: green;
">Started</button>
                            </form>
                        </div>
                        {%else%}

                    <div style= "padding-right: 50px; padding-top: 10px; color: green;" class="col-sm-2">
                        <form method="POST" action="/start/{{ste[endpoint].split('^')[1].split('$')[0]}}/path">
                            <input name="path" class="hide" value="{{endpoint}}"/>
                            <button  class= "startlink" style="
    border: 0;
    background: transparent;
    color: red;
">Stopped</button>
                        </form>
                    </div>
                    {%endif%}
                </div>
            </div>
            <div class=" slidedown-{{count}} indi-slide" style="">
                <div class="clearfix">
                    <span class="glyphicon glyphicon-remove pull-right close-{{count}}"></span>
                </div>
                <h2 style="margin-top:0px;margin-bottom:10px">Edit : {{endpoint}}</h2>
                <div class="row">
                    <form class="form-horizontal col-sm-12" action="/app/{{ste[endpoint].split('^')[1].split('$')[0]}}/changeep"  method="POST" role="form" ng-submit="saveRow()" style="padding-top:20px;">
                       <div class="form-group ">
                            <label class="col-sm-2 control-label">Path</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" name="path" ng-model="path"  style="
                            width: 500px;
                            border-radius: 0;
                            "/ value="{{endpoint}}">
                            </div>
                        </div>
                        <input class="hide" value="{{ste[endpoint].split('^')[1].split('$')[0]}}"/>
                        <div class="form-group">

                            <label class="col-sm-2 control-label">Method</label>
                            <div class="col-sm-10">
                                <div class="dropdown">

                                    <select class="form-control" name="method" style="width:30%;">
                                        <option value="GET">GET</option>
                                        <option value="PUT">PUT</option>
                                        <option value="POST">POST</option>
                                        <option value="DELETE">DELETE</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Response</label>
                            <div class="col-sm-10">
                <textarea type="text" class="form-control" name="response" ng-model="response" style="
                width: 526px;
                height: 164px;
                border-radius: 0;
                "></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <input type="submit" value="Submit" class="btn btn-primary" style="
                background-color: #2E2C2C;
                border-color: #2E2C2C;
                border-radius: 0;
                "/>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <script>    $(".close-{{count}}").on("click",function(e){
                    e.preventDefault();

                    a.removeClass("hide");
                    $(".slidedown-{{count}}").slideUp(1000);
                });
            </script>
            {%endfor%}
            {%endif%}




        </div>

    </div>


</div>


<!-- scripts -->

<script>
var a;
$(".start-link").on("click",function () {

    $(".start-link").addClass("hide");
    $(".stop-link ").removeClass("hide");
    

});

$(".stop-link").on("click",function () {
    $(".stop-link").addClass("hide");
    $(".start-link ").removeClass("hide");
    
});
$(".stoplink,.startlink").on("click",function () {
$('#successMessage').parent().removeClass("hide");
});
var i=0;

</script>


</body>
</html>
